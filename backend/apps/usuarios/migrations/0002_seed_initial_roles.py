# Generated by Django - NO BORRAR ESTA L√çNEA

from django.db import migrations


def crear_roles_iniciales(apps, schema_editor):
    """
    Crea los roles iniciales del sistema.
    Esta funci√≥n se ejecuta cuando se aplica la migraci√≥n.
    """
    # Obtener el modelo Rol (de forma segura para migraciones)
    Rol = apps.get_model('usuarios', 'Rol')
    
    # Lista de roles a crear
    roles_iniciales = [
        'Estudiante',
        'Profesor', 
        'Admin'
    ]
    
    # Crear cada rol si no existe
    for nombre_rol in roles_iniciales:
        Rol.objects.get_or_create(nombre=nombre_rol)
        print(f'‚úÖ Rol "{nombre_rol}" verificado/creado')


def eliminar_roles_iniciales(apps, schema_editor):
    """
    Rollback: Elimina los roles si necesitas revertir la migraci√≥n.
    """
    Rol = apps.get_model('usuarios', 'Rol')
    
    roles_a_eliminar = ['Estudiante', 'Profesor', 'Admin']
    
    Rol.objects.filter(nombre__in=roles_a_eliminar).delete()
    print('üóëÔ∏è  Roles iniciales eliminados')


class Migration(migrations.Migration):
    
    # Esta migraci√≥n depende de la migraci√≥n anterior
    dependencies = [
        ('usuarios', '0001_initial'),
    ]
    
    # Operaciones a ejecutar
    operations = [
    migrations.RunPython(
        crear_roles_iniciales,      # ‚Üê Con indentaci√≥n correcta
        eliminar_roles_iniciales    # ‚Üê Con indentaci√≥n correcta
    ),
    ]